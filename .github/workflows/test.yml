name: Testing
on:
  workflow_dispatch:
  push:

jobs:
  determine-team:
    runs-on: ubuntu-latest

    outputs:
      team: ${{ steps.choose_team.outputs.team }}

    steps:
      - name: Choose team from variable
        id: choose_team
        shell: python
        env:
          TEST_VALUES: ${{ vars.TEST }}
        run: |
          import os

          test = int(os.environ['TEST_VALUES'])

          print(test)

          test = test.split('\n')

          test.append('10000')

          with open(os.environ['GITHUB_OUTPUT'], 'a') as fh:
              print(f'test={test.join('\n')}\n', file=fh)

      - uses: actions/checkout@v3
      - name: Update team value
        env:
          GITHUB_TOKEN: ${{ secrets.GH_TOKEN_UPDATE_VARIABLES }}
        run: gh variable set TEST --body ${{ steps.choose_team.outputs.test }}
